# ÐžÐºÐ¾Ð½Ð½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸

Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°Ð¼ Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾ ðŸ¥‘  
**_Ð˜Ð¼ÐµÐµÑ‚ÑÑ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°:_**   

- **_date_** â€“ Ð´Ð°Ñ‚Ð°
- **_average_price_** â€“ ÑÑ€ÐµÐ´Ð½ÑÑ Ñ†ÐµÐ½Ð° Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾
- **_total_volume_** â€“  
- **_   _** â€“
- **_   _** â€“
- **_   _** â€“
- **_   _** â€“
- **_   _** â€“
- **_   _** â€“
- **_   _** â€“

total_volume â€” ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾
plu4046 â€” ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾ PLU* 4046
plu4225 â€” ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾ PLU 4225
plu4770 â€” ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¾Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾ PLU 4770
total_bags â€” Ð²ÑÐµÐ³Ð¾ ÑƒÐ¿Ð°ÐºÐ¾Ð²Ð¾Ðº
small_bags â€” Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¸Ðµ ÑƒÐ¿Ð°ÐºÐ¾Ð²ÐºÐ¸
large_bags â€” Ð±Ð¾Ð»ÑŒÑˆÐ¸Ðµ
xlarge_bags â€” Ð¾Ñ‡ÐµÐ½ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ðµ
type â€” Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ð¸Ð»Ð¸ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹
year â€” Ð³Ð¾Ð´
region â€” Ð³Ð¾Ñ€Ð¾Ð´ Ð¸Ð»Ð¸ Ñ€ÐµÐ³Ð¸Ð¾Ð½ (TotalUS â€“ ÑÑ€Ð°Ð·Ñƒ Ð¿Ð¾ Ð¡Ð¨Ð)
Ð’ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ Ð½Ð°Ñ…Ð¾Ð´ÑÑ‚ÑÑ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ðµ Ð·Ð° ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ, Ð° Ð·Ð° ÐºÐ¾Ð½ÐµÑ† ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ð¸. Ð”Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð´Ð°Ñ‚Ñ‹ ÐµÑÑ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ð¹, Ð¾Ñ‚Ð»Ð¸Ñ‡Ð°ÑŽÑ‰Ð¸Ñ…ÑÑ Ð¿Ð¾ Ñ‚Ð¸Ð¿Ñƒ Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾ Ð¸ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ñƒ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸. 
  ____________
*Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ð¼ Ð½Ð° Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸ Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾ Ð² Ð´Ð²ÑƒÑ… Ð³Ð¾Ñ€Ð¾Ð´Ð°Ñ… (NewYork, LosAngeles) Ð¸ ÑƒÐ·Ð½Ð°ÐµÐ¼, 
ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð°Ð²Ð¾ÐºÐ°Ð´Ð¾ Ñ‚Ð¸Ð¿Ð° organic Ð±Ñ‹Ð»Ð¾ Ð¿Ñ€Ð¾Ð´Ð°Ð½Ð¾ Ð² Ñ†ÐµÐ»Ð¾Ð¼ Ðº ÐºÐ¾Ð½Ñ†Ñƒ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ð¸ (Ð½Ð°ÐºÐ¾Ð¿Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ ÑÑƒÐ¼Ð¼Ð° Ð¿Ñ€Ð¾Ð´Ð°Ð¶), 
Ð½Ð°Ñ‡Ð¸Ð½Ð°Ñ Ñ Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð° Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ð¹ (04/01/15).
Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ð¾ÐºÐ½Ð° ÑÐ¾Ñ€Ñ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾ Ð´Ð°Ñ‚Ðµ, Ð° ÑÐ°Ð¼Ñƒ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð¾Ñ‚ÑÐ¾Ñ€Ñ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾ ÑƒÐ±Ñ‹Ð²Ð°Ð½Ð¸ÑŽ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð° (ÑÐ½Ð°Ñ‡Ð°Ð»Ð° NY, Ð¿Ð¾Ñ‚Ð¾Ð¼ LA) Ð¸ Ð¿Ð¾ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°Ð½Ð¸ÑŽ Ð´Ð°Ñ‚Ñ‹.
Ð’ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ð° ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð¾Ð±ÑŠÐµÐ¼ Ð¿Ñ€Ð¾Ð´Ð°Ð¶ Ð² ÐÑŒÑŽ Ð™Ð¾Ñ€ÐºÐµ Ð½Ð° 01/03/15 (Ð±ÐµÐ· Ð·Ð°Ð¿ÑÑ‚Ñ‹Ñ…).*
  
```sql
SELECT *
FROM 
    (
    SELECT 
        region,
        date,
        total_volume,
        sum(total_volume) OVER (PARTITION BY region
                                ORDER BY date
                                ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) volume
    FROM avocado
    WHERE region in ('NewYork', 'LosAngeles') 
                AND type = 'organic'
                AND date >= '01/04/15'::date

    ORDER BY region DESC, date
   ) as t
WHERE date = '03/01/15'::date
```
__________
