# Оконные функции

Данные по продажам авокадо 🥑  
**_Имеется таблица:_**   

- **_date_** – дата
- **_average_price_** – средняя цена одного авокадо
- **_total_volume_** –  
- **_   _** –
- **_   _** –
- **_   _** –
- **_   _** –
- **_   _** –
- **_   _** –
- **_   _** –

total_volume — количество проданных авокадо
plu4046 — количество проданных авокадо PLU* 4046
plu4225 — количество проданных авокадо PLU 4225
plu4770 — количество проданных авокадо PLU 4770
total_bags — всего упаковок
small_bags — маленькие упаковки
large_bags — большие
xlarge_bags — очень большие
type — обычный или органический
year — год
region — город или регион (TotalUS – сразу по США)
В таблице находятся данные не за каждый день, а за конец каждой недели. Для каждой даты есть несколько наблюдений, отличающихся по типу авокадо и региону продажи. 
  ____________
*Давайте посмотрим на продажи авокадо в двух городах (NewYork, LosAngeles) и узнаем, 
сколько авокадо типа organic было продано в целом к концу каждой недели (накопительная сумма продаж), 
начиная с начала периода наблюдений (04/01/15).
Значения внутри окна сортируйте по дате, а саму таблицу отсортируйте по убыванию региона (сначала NY, потом LA) и по возрастанию даты.
В качестве ответа укажите объем продаж в Нью Йорке на 01/03/15 (без запятых).*
  
```sql
SELECT *
FROM 
    (
    SELECT 
        region,
        date,
        total_volume,
        sum(total_volume) OVER (PARTITION BY region
                                ORDER BY date
                                ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) volume
    FROM avocado
    WHERE region in ('NewYork', 'LosAngeles') 
                AND type = 'organic'
                AND date >= '01/04/15'::date

    ORDER BY region DESC, date
   ) as t
WHERE date = '03/01/15'::date
```
__________
