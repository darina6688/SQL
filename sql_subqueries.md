# Подзапросы  

Данные для следующих задач: Airbnb в Берлине. Не забывайте о преобразовании столбцов к нужному типу данных!
**_Имеются следующие таблицы:_**   

**1. listings** – информация о жилье, включая полные описания, характеристики и средние оценки в отзывах; поскольку столбцов очень много, нужные перечислены в текстах самих задач  

**2. calendar_summary** – информация о доступности и цене того или иного жилья по дням  
- **_listing_id_** – идентификатор жилья (объявления)  
- **_date_** – дата  
- **_available_** – доступность жилья в данный день (t/f)  
- **_price_** – цена за ночь  

**3. reviews** – отзывы  
- **_listing_id_** –  идентификатор жилья  
- **_id_** – id отзыва  
- **_date_** – дата отзыва  
- **_reviewer_id_** – id ревьюера (автора отзыва)  
- **_reviewer_name_** – имя автора  
- **_comments_** – сам отзыв  
  ____________
*Сначала оставьте только те объявления, в которых оценка на основе отзывов выше среднего, а число отзывов в месяц составляет строго меньше трёх. 
Затем отсортируйте по убыванию две колонки: сначала по числу отзывов в месяц, потом по оценке. В качестве ответа укажите id объявления из первой строки.*
  
```sql
SELECT
    column_1,
    column_2
FROM
    table
WHERE
    column_2 = (SELECT MAX(column_2) 
                FROM table)
```
